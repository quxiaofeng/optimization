<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>K-means, K-SVD, LC-KSVD and DPL | OPTIMIZATIONS for Machine Learning</title>
  <meta name="description" content="从 K-means 到 K-SVD{% sidenote 1 ‘M. Aharon, M. Elad, and A.M. Bruckstein, “The K-SVD: An Algorithm for Designing of Overcomplete Dictionaries for Sparse Repre...">


  <link rel="stylesheet" href="//www.quxiaofeng.me/css/tufte.css">


  <!-- Google Fonts loaded here -->
  <link href='//fonts.useso.com/css?family=Lato:400,400italic' rel='stylesheet' type='text/css'>

  <!-- Load up MathJax script if needed ... specify in /_data/options.yml file-->
  
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  

  <!-- Load up KaTeX script if needed ... specify in /_data/options.yml file-->
  
  <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.js"></script>
  

  <link rel="canonical" href="http://www.quxiaofeng.me/optimization/optimization/2015/08/04/kmeans-ksvd-lcksvd-dpl/">
  <link rel="alternate" type="application/rss+xml" title="OPTIMIZATIONS for Machine Learning" href="http://www.quxiaofeng.me/optimization/optimization/feed.xml" />
</head>

  <body>
    <!--- Header and nav template site-wide -->
<header>
    <nav class="group">
		<a href="//www.quxiaofeng.me/"><img class="badge" src="//www.quxiaofeng.me/assets/img/badge_op_ml.png" alt="OP"></a>
		<a href="//www.quxiaofeng.me/">Home</a>
		<a href="//www.quxiaofeng.me/about">About</a>
	</nav>
</header>

    <article>
      <h1>K-means, K-SVD, LC-KSVD and DPL</h1>
<p>August 4, 2015</p>


<p>从 K-means 到 <a href="http://www.cs.technion.ac.il/~elad/publications/journals/2004/32_KSVD_IEEE_TSP.pdf">K-SVD</a><sup class="sidenote-number">1</sup><span class="sidenote"><sup class="sidenote-number">1</sup> M. Aharon, M. Elad, and A.M. Bruckstein, “The K-SVD: An Algorithm for Designing of Overcomplete Dictionaries for Sparse Representation”, the IEEE Trans. On Signal Processing, Vol. 54, no. 11, pp. 4311-4322, November 2006. <a href="http://www.cs.technion.ac.il/~elad/publications/journals/2004/32_KSVD_IEEE_TSP.pdf">http://www.cs.technion.ac.il/~elad/publications/journals/2004/32_KSVD_IEEE_TSP.pdf</a></span><sup class="sidenote-number">2</sup><span class="sidenote"><sup class="sidenote-number">2</sup> O. Bryt and M. Elad, Compression of Facial Images Using the K-SVD Algorithm, Journal of Visual Communication and Image Representation, Vol. 19, No. 4, Pages 270-283, May 2008. <a href="http://www.cs.technion.ac.il/~elad/publications/journals/2007/FaceCompress_KSVD_JVCIR.pdf">http://www.cs.technion.ac.il/~elad/publications/journals/2007/FaceCompress_KSVD_JVCIR.pdf</a></span><sup class="sidenote-number">3</sup><span class="sidenote"><sup class="sidenote-number">3</sup> R. Rubinstein, T. Peleg and M. Elad, Analysis K-SVD: A Dictionary-Learning Algorithm for the Analysis Sparse Model, IEEE Trans. on Signal Processing, Vol. 61, No. 3, Pages 661-677, March 2013. <a href="http://www.cs.technion.ac.il/~elad/publications/journals/2011/Analysis-KSVD-IEEE-TSP.pdf">http://www.cs.technion.ac.il/~elad/publications/journals/2011/Analysis-KSVD-IEEE-TSP.pdf</a></span>，到 <a href="http://www.umiacs.umd.edu/~zhuolin/projectlcksvd.html">LC-KSVD</a><sup class="sidenote-number">4</sup><span class="sidenote"><sup class="sidenote-number">4</sup> Zhuolin Jiang, Zhe Lin, Larry S. Davis. “Label Consistent K-SVD: Learning A Discriminative Dictionary for Recognition”. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2013, 35(11): 2651-2664. <a href="http://www.umiacs.umd.edu/~zhuolin/projectlcksvd.html">http://www.umiacs.umd.edu/~zhuolin/projectlcksvd.html</a></span>，到 <a href="http://papers.nips.cc/paper/5600-spectral-clustering-of-graphs-with-the-bethe-hessian">DPL</a><sup class="sidenote-number">5</sup><span class="sidenote"><sup class="sidenote-number">5</sup> Gu, S., Zhang, L., Zuo, W., &amp; Feng, X. (2014). Projective dictionary pair learning for pattern classification. In Z. Ghahramani, M. Welling, C. Cortes, N. D. Lawrence, &amp; K. Q. Weinberger (Eds.), Advances in Neural Information Processing Systems 27 (pp. 793–801). Curran Associates, Inc. <a href="http://papers.nips.cc/paper/5600-spectral-clustering-of-graphs-with-the-bethe-hessian">http://papers.nips.cc/paper/5600-spectral-clustering-of-graphs-with-the-bethe-hessian</a></span>。</p>

<hr />

<p><strong>K-means 算法</strong></p>

<p>任务：通过最近邻寻找能够表达数据样本 ​<script type="math/tex">\{\mathbf{y}_i\}^N_{i=1}</script> 的最优编码本（codebook，既字典参数），既求解如下问题</p>

<p>​<script type="math/tex; mode=display">\min_{\mathbf{C, X}} \left\{ \|\mathbf{Y} - \mathbf{CX}\|^2_F \right\} \text{ subject to } \forall i \text{, } \mathbf{x}_i = \mathbf{e}_k \text{ for some } k</script></p>

<!--more-->

<p>初始化： 设置编码本矩阵 ​<script type="math/tex">\mathbf{C}^{(0)} \in \Re^{n \times K}</script>. 设置 ​<script type="math/tex">J=1</script>。</p>

<p>循环至收敛 （使用停止规则）</p>

<p><strong>1.</strong> 稀疏编码阶段：将训练样本 ​<script type="math/tex">{\bf Y}</script> 分为如下 ​<script type="math/tex">K</script> 个集合。</p>

<p>​<script type="math/tex; mode=display">\left( \mathbf{R}^{(J-1)}_1, \mathbf{R}^{(J-1)}_2, \cdots, \mathbf{R}^{(J-1)}_K \right)</script></p>

<p>每个集合中存放与 ​<script type="math/tex">{\bf c}^{J-1}_k</script> 列最相似的样本的索引。</p>

<p>​<script type="math/tex; mode=display"> \mathbf{R}^{(J-1)}_k = \left\{ i \mid \forall_{l \neq k}, \|\mathbf{y}_i - \mathbf{c}^{(J-1)}_k\|_2 &lt; \|\mathbf{y}_i - \mathbf{c}^{(J-1)}_l\|_2  \right\} </script></p>

<p><strong>2.</strong> 编码本更新阶段：​<script type="math/tex">{\bf C}^{(J-1)}</script> 中的任一列 ​<script type="math/tex">k</script> 都根据如下公式更新。</p>

<p>​<script type="math/tex; mode=display">{\bf c}^{(J)}_k = \frac{1}{|{\bf R}_k|}\sum_{i \in {\bf R}^{(J-1)}_k}{\bf y}_i</script></p>

<p><strong>3.</strong> 令​<script type="math/tex"> J = J + 1 </script></p>

<hr />

<p>K-means 相当于是只使用编码本矩阵中的一列的稀疏表达。又因为只有一列，所以系数为1。其中该列由如下公式确定。</p>

<p>​<script type="math/tex; mode=display">\forall_{k \neq j} \; \left\|{\bf y}_i - {Ce}_j \right\|^2_2 \leqslant \left\|{\bf y}_i - {Ce}_k \right\|^2_2</script></p>

<!--more-->

<p>Julia Code Highlight Test</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="kp">include</span><span class="p">(</span><span class="s2">"diagadd!.jl"</span><span class="p">)</span>

<span class="n">function</span> <span class="n">updateA!</span><span class="p">(</span><span class="no">A</span><span class="o">::</span><span class="no">Array</span><span class="p">{</span><span class="no">Any</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span> 
                  <span class="no">D</span><span class="o">::</span><span class="no">Array</span><span class="p">{</span><span class="no">Any</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span> 
                  <span class="no">DataMat</span><span class="o">::</span><span class="no">Array</span><span class="p">{</span><span class="no">Any</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span> 
                  <span class="no">P</span><span class="o">::</span><span class="no">Array</span><span class="p">{</span><span class="no">Any</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span> 
                  <span class="err">τ</span><span class="o">::</span><span class="no">Float64</span><span class="p">,</span> 
                  <span class="no">DictSize</span><span class="o">::</span><span class="no">Int64</span><span class="p">)</span>
    <span class="c1"># Update tempDictCoef by Eq. (8)</span>

    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="ss">:length</span><span class="p">(</span><span class="no">A</span><span class="p">)</span>
        <span class="vi">@inbounds</span> <span class="no">TempDict</span><span class="o">::</span><span class="no">Matrix</span><span class="p">{</span><span class="no">Float64</span><span class="p">}</span> <span class="o">=</span> <span class="no">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="vi">@inbounds</span> <span class="no">TempData</span><span class="o">::</span><span class="no">Matrix</span><span class="p">{</span><span class="no">Float64</span><span class="p">}</span> <span class="o">=</span> <span class="no">DataMat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">tempDictCoef</span><span class="o">::</span><span class="no">Matrix</span><span class="p">{</span><span class="no">Float64</span><span class="p">}</span>       <span class="o">=</span> <span class="no">TempDict</span><span class="s1">' * TempDict
        tempDictDataCoef::Matrix{Float64}   = TempDict'</span> <span class="o">*</span> <span class="no">TempData</span>
        <span class="vi">@inbounds</span> <span class="no">C</span><span class="o">::</span><span class="no">Matrix</span><span class="p">{</span><span class="no">Float64</span><span class="p">}</span>        <span class="o">=</span> <span class="no">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="no">TempData</span>
        <span class="n">diagadd!</span><span class="p">(</span><span class="n">tempDictCoef</span><span class="p">,</span> <span class="err">τ</span><span class="p">)</span>
        <span class="n">fma!</span><span class="p">(</span><span class="n">tempDictDataCoef</span><span class="p">,</span> <span class="no">C</span><span class="p">,</span> <span class="err">τ</span><span class="p">)</span>
        <span class="vi">@inbounds</span> <span class="no">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>                      <span class="o">=</span> <span class="n">tempDictCoef</span> <span class="p">\</span> <span class="n">tempDictDataCoef</span>
    <span class="k">end</span>
<span class="k">end</span></code></pre></figure>




    </article>
    <span class="print-footer">K-means, K-SVD, LC-KSVD and DPL - August 4, 2015 - QU Xiaofeng</span>
    <footer>
  <ul class="footer-links group">
    <li><a href="mailto:xiaofeng.qu.hk@ieee.org"><span class="icon-mail"></span></a></li>
    
      <li>
        <a href="//www.twitter.com/quxiaofeng"><span class="icon-twitter"></span></a>
      </li>
    
      <li>
        <a href="//www.facebook.com/quxiaofeng"><span class="icon-facebook"></span></a>
      </li>
    
      <li>
        <a href="//github.com/quxiaofeng"><span class="icon-github"></span></a>
      </li>
    
      <li>
        <a href="//www.quxiaofeng.me/optimization/feed"><span class="icon-feed"></span></a>
      </li>
    
  </ul>
<div class="credits">
<span>&copy; 2018 &nbsp;&nbsp;QU XIAOFENG</span></br>
<span> Themed by <a href="//github.com/clayh53/tufte-jekyll">Tufte</a> &nbsp;&nbsp; Hosted in <a href="//www.github.com">GitHub</a> &nbsp;&nbsp; Powered by <a href="//jekyllrb.com">Jekyll</a></span>
</div>
</footer>

<!-- Load up KaTeX script if needed ... specify in /_data/options.yml file-->

<script src="//www.quxiaofeng.me/assets/js/katex_render.min.js"></script>

  </body>
</html>
